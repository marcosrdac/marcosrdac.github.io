
<!DOCTYPE html>
<html lang="pt_br">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

  <!-- KaTeX -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/katex.min.css" integrity="sha384-VEnyslhHLHiYPca9KFkBB3CMeslnM9CzwjxsEbZTeA21JBm7tdLwKoZmCt3cZTYD" crossorigin="anonymous" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/katex.min.js" integrity="sha384-O4hpKqcplNCe+jLuBVEXC10Rn1QEqAmX98lKAIFBEDxZI0a+6Z2w2n8AEtQbR4CD" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/contrib/auto-render.min.js" integrity="sha384-IiI65aU9ZYub2MY9zhtKd1H2ps7xxf+eb2YFG9lX6uRqpXCvBTOidPRCXCrQ++Uc" crossorigin="anonymous"></script>

    <link rel="stylesheet/less" type="text/css" href="http://www.marcosrdac.com/pt_br/../theme/stylesheet/style.less">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js" type="text/javascript"></script>

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
        disabled="disabled"
    href="http://www.marcosrdac.com/pt_br/../theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
            disabled="disabled"
          href="http://www.marcosrdac.com/pt_br/../theme/pygments/fruity.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="http://www.marcosrdac.com/pt_br/../theme/pygments/fruity.min.css">


  <link rel="stylesheet" type="text/css" href="http://www.marcosrdac.com/pt_br/../theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="http://www.marcosrdac.com/pt_br/../theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="http://www.marcosrdac.com/pt_br/../theme/font-awesome/css/solid.css">





  

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#091B2A">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#091B2A">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#091B2A">

<meta name="author" content="Marcos Conceição" />
<meta name="description" content="importing libraries import numpy as np import matplotlib.pyplot as plt # generating globs N = 100 c = np.asarray([[1, 1], [4, 3]]) x1 = np.stack([np.random.normal(i, 2.0, N) for i in c[0]], axis=1) x2 = np.stack([np.random.normal(i, 1.5, N) for …" />
<meta name="keywords" content="">


<meta property="og:site_name" content="Marcos Conceição"/>
<meta property="og:title" content="The simplest k-means implementation in Python"/>
<meta property="og:description" content="importing libraries import numpy as np import matplotlib.pyplot as plt # generating globs N = 100 c = np.asarray([[1, 1], [4, 3]]) x1 = np.stack([np.random.normal(i, 2.0, N) for i in c[0]], axis=1) x2 = np.stack([np.random.normal(i, 1.5, N) for …"/>
<meta property="og:locale" content="pt_BR"/>
<meta property="og:url" content="http://www.marcosrdac.com/pt_br/drafts/the-simplest-k-means-implementation-in-python-en.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-12-23 00:00:00-03:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="http://www.marcosrdac.com/pt_br/author/marcos-conceicao.html">
<meta property="article:section" content="blog"/>
<meta property="og:image" content="/images/base/me.png">

  <title>Marcos Conceição &ndash; The simplest k-means implementation in Python</title>

</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="http://www.marcosrdac.com/pt_br">
        <img src="/images/base/me.png" alt="Marcos Conceição" title="Marcos Conceição">
      </a>

      <h1>
        <a href="http://www.marcosrdac.com/pt_br">Marcos Conceição</a>
      </h1>



      <ul class=languages>
      <li><a class="btn" href="http://www.marcosrdac.com/">English</a></li>
      <li class="active"><a class="btn" href="http://www.marcosrdac.com/pt_br/">Português</a></li>
      </ul>



      <nav>
        <ul class="list">


              <li>
                <a target="_self"
                   href="http://www.marcosrdac.com/pt_br/pages/sobre.html#sobre">
                  Sobre
                </a>
              </li>
              <li>
                <a target="_self"
                   href="http://www.marcosrdac.com/pt_br/pages/contato.html#contato">
                  Contato
                </a>
              </li>
              <li>
                <a target="_self"
                   href="http://www.marcosrdac.com/pt_br/pages/portefolio.html#portefolio">
                  Portefólio
                </a>
              </li>
              <li>
                <a target="_self"
                   href="http://www.marcosrdac.com/pt_br/pages/servicos.html#servicos">
                  Serviços
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/marcosrdac" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-linkedin" href="https://www.linkedin.com/in/marcos-concei%C3%A7%C3%A3o-3ba173189/" target="_blank">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
          <li>
            <a  class="sc-youtube" href="https://www.youtube.com/channel/UCeMnyCimF8pJjTM5MxFdRlw" target="_blank">
              <i class="fab fa-youtube"></i>
            </a>
          </li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="http://www.marcosrdac.com/pt_br">Início</a>

      <!--MODIFIED-->
      <!--<a href="archives.html">Arquivos</a>-->
      <a href="http://www.marcosrdac.com/pt_br/archives.html">Arquivos</a>
      <!--MODIFIED-->
      <!--<a href="categories.html">Categorias</a>-->
      <a href="http://www.marcosrdac.com/pt_br/categories.html">Categorias</a>
      <!--MODIFIED-->
      <!--<a href="tags.html">Tags</a>-->
      <a href="http://www.marcosrdac.com/pt_br/tags.html">Tags</a>


    </nav>

<article class="single">
  <header>
      
    <h1 id="the-simplest-k-means-implementation-in-python">The simplest k-means implementation in Python</h1>
    <p>
      Publicado em qua 23 dezembro 2020 na categoria <a href="http://www.marcosrdac.com/pt_br/category/blog.html">blog</a>

        &#8226; 1 min de leitura 
    </p>
  </header>


  <div>
    <p>importing libraries</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="c1"># generating globs</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<p>generating dataset</p>
<div class="highlight"><pre><span></span><code><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">i</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])])</span>
</code></pre></div>


<p>the k-means algorithm</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to calculate centroids and predict labels of distributions with</span>
<span class="sd">    K-means algorithm.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span>
    <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">dists</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">dists</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span>
</code></pre></div>


<p>running kmeans</p>
<div class="highlight"><pre><span></span><code><span class="n">ŷ</span><span class="p">,</span> <span class="n">ĉ</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div>


<p>plotting results</p>
<div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ŷ</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">y</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
    <span class="n">ŷ</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ŷ</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">ŷ</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ĉ</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ĉ</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ĉ</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ĉ</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
  </div>
  <div class="tag-cloud">
    <p>
    </p>
  </div>





</article>

    <footer>
<p>&copy;  </p>
<p>
Criado com o <a href="http://getpelican.com" target="_blank">Pelican</a> usando o tema <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a>
  <span class="footer-separator">|</span>
  Alterar tema para <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> 
  <script id="dark-theme-script"
          src="http://www.marcosrdac.com/pt_br/../theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="false"
          data-default-theme="light"
          type="text/javascript">
  </script>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Marcos Conceição ",
  "url" : "http://www.marcosrdac.com/pt_br",
  "image": "/images/base/me.png",
  "description": "A site by Marcos Conceição."
}
</script>


</body>

<!-- KaTeX -->
<script>renderMathInElement(document.body);</script>

</html>